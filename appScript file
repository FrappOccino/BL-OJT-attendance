function attendanceButton(){
  onOpen();
}

function onOpen() {
  var ui = SpreadsheetApp.getUi();
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();

  var response = ui.alert(
    'Time in?',
    '',
    ui.ButtonSet.YES_NO
  );

  if (response == ui.Button.YES) {
    var nameEntered;
    var lastName;
    do {
      nameEntered = promptForName(ui);
      lastName = getLastName(nameEntered);
      if (lastName === "who you?") {
        ui.alert('Invalid name', 'Please enter a valid name.', ui.ButtonSet.OK);
      }
    } while (lastName === "who you?");
    
    var lastRow = sheet.getLastRow();
    var currentTime = new Date();
    var timeString = Utilities.formatDate(currentTime, Session.getScriptTimeZone(), 'HH:mm:ss');

    sheet.getRange('A' + (lastRow + 1)).setValue(nameEntered);
    sheet.getRange('B' + (lastRow + 1)).setValue(lastName);
    sheet.getRange('C' + (lastRow + 1)).setValue(new Date());
    sheet.getRange('D' + (lastRow + 1)).setValue(timeString);

    Logger.log('Name entered: ' + nameEntered);
    Logger.log('Last name inserted: ' + lastName);
    Logger.log('Current time inserted in columns C and D.');
  } else if (response == ui.Button.NO) {
    var responseOut = ui.Button.YES; // Initialize with YES to enter the loop
    while (responseOut == ui.Button.YES) {
      responseOut = ui.alert('Time out?', '', ui.ButtonSet.YES_NO);
      if (responseOut == ui.Button.YES) {
        var nameEntered;
        var lastName;
        do {
          nameEntered = promptForName(ui);
          lastName = getLastName(nameEntered);
          if (lastName === "who you?") {
            ui.alert('Invalid name', 'Please enter a valid name.', ui.ButtonSet.OK);
          }
        } while (lastName === "who you?");
        
        var currentTime = new Date();
        var timeString = Utilities.formatDate(currentTime, Session.getScriptTimeZone(), 'HH:mm:ss');

        var data = sheet.getDataRange().getValues();
        for (var i = 1; i < data.length; i++) {
          if (data[i][0] === nameEntered && new Date(data[i][2]).toDateString() === new Date().toDateString()) {
            sheet.getRange('E' + (i + 1)).setValue(timeString);
            Logger.log('Time out inserted in column E for ' + nameEntered);
            break;
          }
        }break;
      }
      //break;
    }
    return; // Exit the function if "NO" is clicked for "Time out"
  } else {
    Logger.log('The user clicked the close button in the dialog\'s title bar for Time in.');
  }
}

function promptForName(ui) {
  var input = ui.prompt('Enter name:');
  return input.getResponseText();
}

function getLastName(nameEntered) {
  switch (nameEntered.toLowerCase()) {
    case "kurt":
      return "garcia";
    case "jeff":
      return "wong";
    case "cyjay":
      return "cunanan";
    case "joshuac":
      return "carbungco";
    case "joshuan":
      return "lee";
    case "mark":
      return "santos";
    default:
      return "who you?";
  }
}
